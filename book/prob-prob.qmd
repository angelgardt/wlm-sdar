# Вероятность как математическая конструкция {#prob}

{{< include other/_symbols.qmd >}}

```{r opts, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, error=FALSE}
knitr::opts_chunk$set(echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, error=FALSE)
```

```{r pkgs}
library(tidyverse)
theme_set(theme_bw())
```


:::{.intro}
Озадачимся более серьезно построением «вероятности» с опорой на фундамент всей современной математики --- теорию множеств.
:::


## Эксперименты со случайным исходом {#prob-randexp}

Вернемся к концепции **эксперимента со случайным исходом (случайного эксперимента)**, который как мы выяснили ранее(HREF), происходит каждый раз в момент измерения. Нам необходима некая математическая модель такого эксперимента, чтобы мы могли далее с этим феноменом работать.

Математическая модель случайного эксперимента содержит несколько требований:

1. **Недетерминированность исхода** <br> 
Мы не можем знать наверняка, что произойдет в конкретном эксперименте. В этом смысле бросание теннисного мяса с заданной высоты не является случайным экспериментом, так как исход абсолютно точно известен заранее --- мяч совершит движение вертикально вниз и ударится оземь.
1. **Принципиальная возможность повторения эксперимента** (во времени и/или в пространстве) <br>
Мы можем повторить наш эксперимент сколь угодно большое количество раз. Причем эти повторения могут быть разнесены друг от друга во времени (100 раз подряд подбросить одну и ту же монетку) или в пространстве (одновременно подбросить 100 монеток). В этом смысле сдача экзамена некоторым студентом не является случайным экспериментом --- студент сдает экзамен [в идеале] один раз[^exam-times].
1. **Неизменность условий эксперимента** <br>
Во всех повторениях эксперимента условия его проведения не изменяются. В этом смысле даже если рассмотреть ситуацию трёхкратной сдачи экзамена некоторым студентом, она не является случайным экспериментом, так как студент [наверное, хотелось бы думать, что] готовится к пересдачам, соответственно, условия сдачи экзамена меняются.
1. **В одном повторении эксперимента некий исход может либо реализовать, либо не реализоваться** <br>
Данное требование позволяет ввести такую характеристику исхода случайного эксперимента как *частота*. <br>
Исход $A$ имеет [относительную] частоту $\displaystyle \frac{n(A)}{n}$, если в $n$ повторениях случайного эксперимента этот исход реализовался $n(A)$ раз.
1. **Статистическая устойчивость частоты** <br>
Под этим понимают две вещи:
    - с ростом числа повторений случайного эксперимента относительная частота события $A$ должна приближаться к некоторому значению [@serdobolskaya2019] (@fig-prob-stat-stability-1)
    - в разных сериях случайных экспериментов относительная частота события $A$ (при достаточно большом количестве повторений случайного эксперимента) не должна сильно меняться [@erlikh2019] (@fig-prob-stat-stability-2).

[^exam-times]: Окей, максимум --- три. Этого всё равно не достаточно для выполнения данного требования.

```{r prob-stat-stability-plots}
set.seed(123)

tibble(n = seq(1, 5000, by = 5),
       p = n %>% 
  map(sample, x = 1:6, replace = TRUE) %>% 
  map(table) %>% 
  map(.[1]) %>% 
  unlist() %>% 
  `/`(n)
  ) %>% 
  ggplot(aes(n, p)) +
  geom_point(size = 1) +
  geom_hline(yintercept = 1/6,
             color = "#9AEBC6",
             linewidth = 1) +
  ylim(0, 1) +
  labs(x = "Количество случайных экспериментов",
       y = "Относительная частота") -> plot1


set.seed(956)
sample(1:6, 100*1000, replace = TRUE) %>% 
  matrix(ncol = 100) %>% 
  apply(2, function(x) sum(x == 1)) %>% 
  `/`(1000) %>% 
  tibble(n = 1:100,
         p = .) %>% 
  ggplot(aes(x = n,
             y = p)) +
  geom_point(size = 1) +
  geom_hline(yintercept = 1/6,
             color = "#36D38C",
             linewidth = 1) +
  ylim(0, 1) +
  labs(x = "Номер серии экспериментов",
       y = "Относительная частота") -> plot2
```

```{r prob-stat-stability-fig}
#| label: fig-prob-stat-stability
#| fig-cap: "Статистическая устойчивость"
#| fig-subcap:
#|   - "С ростом числа испытания относительная частота приближается к некоторому значению"
#|   - "В разных сериях испытаний относительная частота примерно постоянна"
#| layout-ncol: 2

print(plot1)
print(plot2)
```


```{=html}
<script type="text/javascript" src="./js/chapter.js"></script>
```
