set.seed(115)
tibble(x = seq(0, 20, by = .01),
y = df(x, 5, 10)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 20, by = .01),
y = df(x, 8, 10)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 20, by = .01),
y = df(x, 20, 10)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 20, by = .01),
y = df(x, 20, 100)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 20, by = .01),
y = dpois(x, 20)) -> median_leftskew_data
tibble(x = seq(0, 20, by = .01),
y = dpois(x, 20)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 10, by = .01),
y = dpois(x, 20)) -> median_leftskew_data
set.seed(115)
tibble(x = seq(0, 10, by = .01),
y = dgamma(x, 2, 2)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 5, by = .001),
y = dgamma(x, 2, 2)) -> median_leftskew_data
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0, 5, by = .001),
y = dgamma(x, 2, 2)) -> median_rightskew_data
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_rightskew_data |>
filter(x <= 1) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(.845, min(median_rightskew_data$x))),
.) -> median_rightskew_data_lower
DescTools::AUC(median_rightskew_data_lower$x,
median_rightskew_data_lower$y)
median_rightskew_data |>
filter(x <= 1) -> median_rightskew_data_lower
DescTools::AUC(median_rightskew_data_lower$x,
median_rightskew_data_lower$y)
median_rightskew_data |>
filter(x <= .9) -> median_rightskew_data_lower
DescTools::AUC(median_rightskew_data_lower$x,
median_rightskew_data_lower$y)
median_rightskew_data |>
filter(x <= .85) -> median_rightskew_data_lower
DescTools::AUC(median_rightskew_data_lower$x,
median_rightskew_data_lower$y)
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
# geom_vline(xintercept = 0.845, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
# geom_polygon(data = median_leftskew_data_lower,
#              aes(x = x, y = y), fill = "royalblue", alpha = .5) +
# geom_polygon(data = median_leftskew_data_upper,
#              aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_rightskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_rightskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_rightskew_data |>
filter(x >= .85) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(max(median_rightskew_data$x), .85)),
.) -> median_rightskew_data_upper
median_rightskew_data |>
filter(x <= .85) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(.85, min(median_rightskew_data$x))),
.) -> median_rightskew_data_lower
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_rightskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_rightskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_leftskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_leftskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.845, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = .9, y = 1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .8, y = 1) +
labs(x = "Value", y = "Density")
set.seed(115)
tibble(x = seq(0.3, 1, by = .001),
y = dbeta(x, 7, 1.5)) -> median_leftskew_data
median_leftskew_data |>
filter(x >= .845) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(max(median_leftskew_data$x), .845)),
.) -> median_leftskew_data_upper
median_leftskew_data |>
filter(x <= .845) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(.845, min(median_leftskew_data$x))),
.) -> median_leftskew_data_lower
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_leftskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_leftskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.845, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = .9, y = 1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .8, y = 1) +
labs(x = "Value", y = "Density")
median_leftskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_leftskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_leftskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.845, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = .9, y = 1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .8, y = 1) +
labs(x = "Value", y = "")
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_rightskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_rightskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 1.25, y = .2) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .5, y = .2) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_bimodal_data_build |>
ggplot(aes(x, y)) +
geom_histogram(data = median_bimodal_data,
aes(x = x, y = after_stat(density)),
fill = "gray90", binwidth = .4) +
geom_line() +
geom_polygon(data = median_bimodal_data_build_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_bimodal_data_build_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = m, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 2.25, y = .1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = 1.25, y = .1) +
labs(x = "Value", y = "Density")
update.packages("quarto")
install.packages("leaflet")
library(tidyverse)
theme_set(theme_bw())
alpha_multiple_comp <- function(n, alpha = .05) {1 - (1 - alpha) ^ n}
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point()
library(latex2exp)
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
labs(x = "Number of comparisons",
y = TeX("\(\alpha\)"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
labs(x = "Number of comparisons",
y = TeX("$\alpha$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
labs(x = "Number of comparisons",
y = TeX("$$\alpha$$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
labs(x = "Number of comparisons",
y = TeX("$$\|alpha$$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha$$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
scale_y_continuous(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha$$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
scale_y_discrete(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha$$"))
tibble(n = 1:10,
alpha = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n)) |>
ggplot(aes(x = n, y = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n, alpha = .001)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n, alpha = .001)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
scale_color_discrete(lables = c(alpha05 = "0.05", alpha001 = "0.001")) |>
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n, alpha = .001)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
scale_color_discrete(labels = c(alpha05 = "0.05", alpha001 = "0.001")) |>
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n, alpha = .001)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
scale_color_discrete(labels = c(alpha05 = "0.05", alpha001 = "0.001")) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha'$$"))
tibble(n = 1:10,
alpha05 = alpha_multiple_comp(n),
alpha001 = alpha_multiple_comp(n, alpha = .001)) |>
pivot_longer(cols = -n, names_to = "alpha", values_to = "value") |>
ggplot(aes(x = n, y = value, color = alpha)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:10) +
scale_color_discrete(labels = c(alpha05 = "0.05", alpha001 = "0.001")) +
labs(x = "Number of comparisons",
y = TeX("$$\\alpha$$"),
color = "Level of Significance") +
theme(legend.position = "bottom")
tibble(x = seq(-5, 7, by = .001),
...0_1 = dnorm(x, mean = 0, sd = 1),
...1_1 = dnorm(x, mean = 1, sd = 1),
...1_2 = dnorm(x, mean = 1, sd = 2),
...m1.5_0.5 = dnorm(x, mean = -1.5, sd = 0.5)) |>
pivot_longer(cols = -x, names_to = "params", values_to = "d") |>
mutate(params = str_replace(params, "...", "μ = ") |> str_replace("_", ", σ = "))
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
source("clrs.R")
library(tidyverse)
theme_set(theme_bw())
library(latex2exp)
alpha <- 0.5
#| label: fig-norm
#| fig-cap: "Нормальное распределение"
tibble(x = seq(-4, 4, by = .001),
d = dnorm(x)) -> stnorm
stnorm |> filter(x > 0 & x < 1) |> bind_rows(tibble(x = c(1, 0), d = c(0, 0))) -> poly01
stnorm |> filter(x < 0 & x > -1) |> bind_rows(tibble(x = c(0, -1), d = c(0, 0))) -> poly0m1
stnorm |> filter(x > 1 & x < 2) |> bind_rows(tibble(x = c(2, 1), d = c(0, 0))) -> poly12
stnorm |> filter(x < -1 & x > -2) |> bind_rows(tibble(x = c(-1, -2), d = c(0, 0))) -> polym1m2
stnorm |> filter(x > 2 & x < 3) |> bind_rows(tibble(x = c(3, 2), d = c(0, 0))) -> poly23
stnorm |> filter(x < -2 & x > -3) |> bind_rows(tibble(x = c(-2, -3), d = c(0, 0))) -> polym2m3
stnorm |> filter(x > 3) |> bind_rows(tibble(x = c(4, 3), d = c(0, 0))) -> poly34
stnorm |> filter(x < -3) |> bind_rows(tibble(x = c(-3, -4), d = c(0, 0))) -> polym3m4
stnorm |>
ggplot(aes(x, d)) +
geom_polygon(data = poly01,
fill = clrs$blue2,
alpha = alpha) +
geom_polygon(data = poly0m1,
fill = clrs$blue2,
alpha = alpha) +
geom_polygon(data = poly12,
fill = clrs$springgreen2,
alpha = alpha) +
geom_polygon(data = polym1m2,
fill = clrs$springgreen2,
alpha = alpha) +
geom_polygon(data = poly23,
fill = clrs$orange2,
alpha = alpha) +
geom_polygon(data = polym2m3,
fill = clrs$orange2,
alpha = alpha) +
geom_polygon(data = poly34,
fill = clrs$red2,
alpha = alpha) +
geom_polygon(data = polym3m4,
fill = clrs$red2,
alpha = alpha) +
geom_line() +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_vline(xintercept = c(-3, -2, -1, 1, 2, 3), linetype = "dotted") +
annotate(geom = "text",
label = c("34.1%", "34.1%", "13.6%", "13.6%", "2.1%", "2.1%", "0.1%", "0.1%"),
x = c(.5, -.5, 1.5, -1.5, 2.5, -2.5, 3.5, -3.5),
y = .05) +
scale_x_continuous(breaks = -4:4,
labels = TeX(
c("", "$$\\mu - 3\\sigma$$", "$$\\mu - 2\\sigma$$", "$$\\mu - \\sigma$$",
"$$\\mu$$",
"$$\\mu + \\sigma$$", "$$\\mu + 2\\sigma$$", "$$\\mu + 3\\sigma$$", "")
)
) +
labs(x = "Values", y = "Density")
tibble(x = seq(-5, 7, by = .001),
...0_1 = dnorm(x, mean = 0, sd = 1),
...1_1 = dnorm(x, mean = 1, sd = 1),
...1_2 = dnorm(x, mean = 1, sd = 2),
...m1.5_0.5 = dnorm(x, mean = -1.5, sd = 0.5)) |>
pivot_longer(cols = -x, names_to = "params", values_to = "d") |>
mutate(params = str_replace(params, "...", "μ = ") |> str_replace("_", ", σ = "))
tibble(x = seq(-5, 7, by = .001),
...0_1 = dnorm(x, mean = 0, sd = 1),
...1_1 = dnorm(x, mean = 1, sd = 1),
...1_2 = dnorm(x, mean = 1, sd = 2),
...m1.5_0.5 = dnorm(x, mean = -1.5, sd = 0.5)) |>
pivot_longer(cols = -x, names_to = "params", values_to = "d") |>
mutate(params = str_replace(params, "...", "μ = ") |> str_replace("_", ", σ = ")) -> norms
norms |>
ggplot(aes(x, d, color = params)) +
geom_line() +
labs(x = "Value", y = "Density") +
scale_color_manual(values = c(clrs$red4, clrs$springgreen4, clrs$violet4, clrs$lightblue4)) +
theme(legend.position = "bottom")
norms |>
ggplot(aes(x, d, color = params)) +
geom_line() +
labs(x = "Value", y = "Density", color = "Parameters") +
scale_color_manual(values = c(clrs$red4, clrs$springgreen4, clrs$violet4, clrs$lightblue4)) +
theme(legend.position = "bottom")
tibble(x = seq(-5, 7, by = .001),
...0_1 = dnorm(x, mean = 0, sd = 1),
...1_1 = dnorm(x, mean = 1, sd = 1),
...1_2 = dnorm(x, mean = 1, sd = 2),
...m1.5_0.5 = dnorm(x, mean = -1.5, sd = 0.5)) |>
pivot_longer(cols = -x, names_to = "params", values_to = "d") |>
mutate(params = str_replace(params, "...", "μ = ") |>
str_replace("_", ", σ = ") |>
str_replace("m", "−")) -> norms
norms |>
ggplot(aes(x, d, color = params)) +
geom_line() +
labs(x = "Value", y = "Density", color = "Parameters") +
scale_color_manual(values = c(clrs$red4, clrs$springgreen4, clrs$violet4, clrs$lightblue4)) +
theme(legend.position = "bottom")
install.packages("webshot2")
install.packages("rytstat")
install.packages("rgoogleclassroom")
install.packages("googlesheets4")
install.packages("Hmisc")
install.packages("webshot2")
